<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>跳转中...</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
  <h3 style="text-align:center;margin-top:40vh">正在跳转…</h3>
  <script>
    /* 把 /r/xxxxx 截出来 */
    const m = location.pathname.match(/^\/r\/([A-Za-z0-9\-_]+)$/);
    if (m) {
      try {
        let s = m[1].replace(/-/g,'+').replace(/_/g,'/');
        while (s.length % 4) s += '=';
        const url = atob(s);
        if (/^https?:/i.test(url)) location.replace(url);
        else throw 1;
      } catch {
        document.body.innerHTML = '<h3>链接格式错误</h3>';
      }
    } else {
      /* 不是 /r/xxxxx 就让回首页 */
      location.replace('/');
    }
  </script>
</body>
</html>
